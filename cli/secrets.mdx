---
title: 'Secrets'
description: 'Manage secrets with sitectl'
---

## Overview

Secrets store encrypted sensitive data like API keys, passwords, database credentials, and certificates. They can be scoped to organizations, projects, or individual sites, allowing you to share secrets across multiple resources or keep them site-specific.

## Secret Scopes

Secrets can be created at three levels:

- **Organization-level**: Shared across all projects and sites in an organization
- **Project-level**: Shared across all sites in a project
- **Site-level**: Specific to a single site

## List Secrets

View secrets at different scopes:

```bash
# Organization secrets
sitectl list secrets --organization-id <org-id>

# Project secrets
sitectl list secrets --project-id <project-id>

# Site secrets
sitectl list secrets --site-id <site-id>
```

### Flags

- `--organization-id`: List organization-level secrets
- `--project-id`: List project-level secrets
- `--site-id`: List site-level secrets
- `--no-cache`: Fetch fresh data from API

<Note>
Secret values are never returned by list or get commands for security. You must have the original value or update it.
</Note>

### Output Formats

```bash
# Table format (default)
sitectl list secrets --site-id site_123abc

# JSON format
sitectl list secrets --site-id site_123abc --format json

# Custom template (only keys, never values)
sitectl list secrets --site-id site_123abc --format '{{.Key}}'
```

### Examples

```bash
# List all secrets for a site
sitectl list secrets --site-id site_123abc

# List project-wide secrets
sitectl list secrets --project-id proj_xyz789

# List organization-wide secrets
sitectl list secrets --organization-id org_abc123

# Find secrets by key pattern
sitectl list secrets --site-id site_123abc --format json | \
  jq '.[] | select(.Key | contains("DATABASE"))'
```

## Get Secret

Retrieve metadata about a specific secret:

```bash
sitectl get secret <secret-id>
```

<Warning>
The secret value is never returned. Only metadata like key name, creation time, and scope.
</Warning>

### Examples

```bash
# Get secret metadata
sitectl get secret secret_xyz123

# Get as JSON
sitectl get secret secret_xyz123 --format json

# Extract key name
sitectl get secret secret_xyz123 --format '{{.Key}}'
```

## Create Secret

Create a new secret at the appropriate scope:

```bash
# Organization secret
sitectl create secrets \
  --organization-id <org-id> \
  --key "SECRET_KEY" \
  --value "secret-value"

# Project secret
sitectl create secrets \
  --project-id <project-id> \
  --key "SECRET_KEY" \
  --value "secret-value"

# Site secret
sitectl create secrets \
  --site-id <site-id> \
  --key "SECRET_KEY" \
  --value "secret-value"
```

### Required Flags

One of:
- `--organization-id`: Create organization-level secret
- `--project-id`: Create project-level secret
- `--site-id`: Create site-level secret

And:
- `--key`: Secret key/name (environment variable name)
- `--value`: Secret value (encrypted at rest)

### Examples

```bash
# Database password for entire organization
sitectl create secrets \
  --organization-id org_abc123 \
  --key "SHARED_DB_PASSWORD" \
  --value "super_secure_password_123"

# API key shared across project
sitectl create secrets \
  --project-id proj_xyz789 \
  --key "STRIPE_API_KEY" \
  --value "sk_test_abc123xyz"

# Site-specific secret
sitectl create secrets \
  --site-id site_123abc \
  --key "DATABASE_URL" \
  --value "postgresql://user:pass@localhost/db"

# Multiple secrets for a site
sitectl create secrets \
  --site-id site_123abc \
  --key "API_KEY" \
  --value "key_abc123"

sitectl create secrets \
  --site-id site_123abc \
  --key "API_SECRET" \
  --value "secret_xyz789"

# Store multiline value (certificate, private key, etc.)
sitectl create secrets \
  --site-id site_123abc \
  --key "TLS_CERTIFICATE" \
  --value "$(cat certificate.pem)"
```

## Edit Secret

Update an existing secret's value:

```bash
sitectl edit secret <secret-id> \
  --value "new-secret-value"
```

### Available Flags

- `--value`: New secret value

<Note>
You cannot change the key name or scope of a secret. Delete and recreate instead.
</Note>

### Examples

```bash
# Update secret value
sitectl edit secret secret_xyz123 \
  --value "new_secure_password"

# Rotate API key
sitectl edit secret secret_xyz123 \
  --value "sk_live_new_key_abc123"

# Update from file
sitectl edit secret secret_xyz123 \
  --value "$(cat new-certificate.pem)"
```

## Delete Secret

Delete a secret:

```bash
sitectl delete secret <secret-id>
```

<Warning>
Deleting a secret cannot be undone. Ensure no applications are using it before deletion.
</Warning>

### Examples

```bash
# Delete secret
sitectl delete secret secret_xyz123

# Confirm before deletion
read -p "Delete secret secret_xyz123? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
  sitectl delete secret secret_xyz123
fi
```

## Complete Workflow Example

```bash
# Get site ID
SITE_ID=$(sitectl list sites --format json | jq -r '.[0].ID')

# Create database credentials
echo "Creating database secrets..."
sitectl create secrets \
  --site-id $SITE_ID \
  --key "DATABASE_HOST" \
  --value "db.example.com"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "DATABASE_NAME" \
  --value "production_db"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "DATABASE_USER" \
  --value "app_user"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "DATABASE_PASSWORD" \
  --value "secure_pass_123"

# Create API keys
echo "Creating API secrets..."
sitectl create secrets \
  --site-id $SITE_ID \
  --key "STRIPE_PUBLISHABLE_KEY" \
  --value "pk_live_abc123"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "STRIPE_SECRET_KEY" \
  --value "sk_live_xyz789"

# Create third-party service credentials
sitectl create secrets \
  --site-id $SITE_ID \
  --key "SENDGRID_API_KEY" \
  --value "SG.abc123xyz"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "AWS_ACCESS_KEY_ID" \
  --value "AKIAIOSFODNN7EXAMPLE"

sitectl create secrets \
  --site-id $SITE_ID \
  --key "AWS_SECRET_ACCESS_KEY" \
  --value "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"

# List all secrets
echo "\nAll secrets for site:"
sitectl list secrets --site-id $SITE_ID

# Rotate a secret
echo "\nRotating database password..."
DB_SECRET_ID=$(sitectl list secrets --site-id $SITE_ID --format json | \
  jq -r '.[] | select(.Key == "DATABASE_PASSWORD") | .ID')

sitectl edit secret $DB_SECRET_ID \
  --value "new_secure_pass_456"

echo "Database password rotated successfully"
```

## Best Practices

<Tip>
**Use appropriate scopes**: Put shared secrets at organization/project level, site-specific secrets at site level
</Tip>

<Warning>
**Never commit secrets to version control**: Use sitectl to manage secrets, not .env files in git
</Warning>

<Note>
**Rotate regularly**: Implement a schedule for rotating sensitive credentials
</Note>

### Recommendations

1. **Naming conventions**: Use UPPER_SNAKE_CASE for secret keys (matches env var style)
2. **Scope wisely**: Organization for company-wide, project for app-wide, site for instance-specific
3. **Rotate credentials**: Regularly update passwords, API keys, and certificates
4. **Audit access**: Review who can access secrets at each level
5. **Document purpose**: Use secret keys that clearly indicate their purpose
6. **Separate by environment**: Use different values for dev/staging/prod, but same keys

## Common Secret Patterns

### Database Credentials

```bash
SITE_ID="site_123abc"

sitectl create secrets --site-id $SITE_ID --key "DB_HOST" --value "localhost"
sitectl create secrets --site-id $SITE_ID --key "DB_PORT" --value "5432"
sitectl create secrets --site-id $SITE_ID --key "DB_NAME" --value "myapp"
sitectl create secrets --site-id $SITE_ID --key "DB_USER" --value "dbuser"
sitectl create secrets --site-id $SITE_ID --key "DB_PASSWORD" --value "secure123"

# Or as connection string
sitectl create secrets \
  --site-id $SITE_ID \
  --key "DATABASE_URL" \
  --value "postgresql://user:pass@localhost:5432/myapp"
```

### API Keys and Tokens

```bash
SITE_ID="site_123abc"

# Payment processor
sitectl create secrets --site-id $SITE_ID --key "STRIPE_PUBLIC_KEY" --value "pk_live_..."
sitectl create secrets --site-id $SITE_ID --key "STRIPE_SECRET_KEY" --value "sk_live_..."

# Email service
sitectl create secrets --site-id $SITE_ID --key "SENDGRID_API_KEY" --value "SG...."

# Cloud storage
sitectl create secrets --site-id $SITE_ID --key "S3_ACCESS_KEY" --value "AKIA..."
sitectl create secrets --site-id $SITE_ID --key "S3_SECRET_KEY" --value "wJal..."
```

### Application Secrets

```bash
SITE_ID="site_123abc"

# Laravel
sitectl create secrets --site-id $SITE_ID --key "APP_KEY" --value "base64:..."

# Django
sitectl create secrets --site-id $SITE_ID --key "SECRET_KEY" --value "django-insecure-..."

# JWT
sitectl create secrets --site-id $SITE_ID --key "JWT_SECRET" --value "your-256-bit-secret"
```

### Certificates and Keys

```bash
SITE_ID="site_123abc"

# TLS certificate
sitectl create secrets \
  --site-id $SITE_ID \
  --key "TLS_CERT" \
  --value "$(cat cert.pem)"

# Private key
sitectl create secrets \
  --site-id $SITE_ID \
  --key "TLS_KEY" \
  --value "$(cat key.pem)"

# CA bundle
sitectl create secrets \
  --site-id $SITE_ID \
  --key "TLS_CA" \
  --value "$(cat ca-bundle.pem)"
```

## Secret Hierarchy

Secrets inherit down the hierarchy: Organization → Project → Site

```bash
# Organization-wide secret (all projects and sites can use)
sitectl create secrets \
  --organization-id org_abc123 \
  --key "COMPANY_API_KEY" \
  --value "company_key_123"

# Project-wide secret (all sites in project can use)
sitectl create secrets \
  --project-id proj_xyz789 \
  --key "PROJECT_DATABASE_URL" \
  --value "postgresql://..."

# Site-specific secret (only this site)
sitectl create secrets \
  --site-id site_123abc \
  --key "SITE_SPECIFIC_TOKEN" \
  --value "token_abc"
```

## Troubleshooting

### Cannot Create Secret

Ensure you have appropriate permissions:

```bash
# Check site membership
sitectl list members --site-id site_123abc

# Check project membership
sitectl list members --project-id proj_xyz789

# Check organization membership
sitectl list members --organization-id org_abc123
```

### Secret Key Already Exists

Each key must be unique within its scope:

```bash
# List existing secrets to check for conflicts
sitectl list secrets --site-id site_123abc

# Use different key name or delete existing
sitectl delete secret <existing-secret-id>
```

### Cannot View Secret Value

This is by design for security. Secret values are write-only through the CLI.

## Output Fields

Available fields for custom templates and JSON output:

| Field | Type | Description |
|-------|------|-------------|
| `ID` | string | Unique secret identifier |
| `Key` | string | Secret key/name |
| `OrganizationID` | string | Organization ID (if org-scoped) |
| `ProjectID` | string | Project ID (if project-scoped) |
| `SiteID` | string | Site ID (if site-scoped) |
| `CreatedAt` | timestamp | Creation timestamp |
| `UpdatedAt` | timestamp | Last update timestamp |

<Note>
The `Value` field is never included in output for security reasons.
</Note>

### Custom Template Examples

```bash
# List just the keys
sitectl list secrets --site-id site_123abc --format '{{.Key}}'

# Table with custom columns
sitectl list secrets --site-id site_123abc \
  --format 'table {{.Key}}\t{{.CreatedAt}}'

# JSON processing
sitectl list secrets --site-id site_123abc --format json | \
  jq '.[] | {key: .Key, id: .ID, created: .CreatedAt}'

# Group by purpose
sitectl list secrets --site-id site_123abc --format json | \
  jq 'group_by(.Key | split("_")[0]) | map({group: .[0].Key | split("_")[0], secrets: map(.Key)})'
```
